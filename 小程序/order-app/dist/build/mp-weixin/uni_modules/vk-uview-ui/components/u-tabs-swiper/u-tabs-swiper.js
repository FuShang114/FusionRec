"use strict";var t=require("../../../../common/vendor.js");let e=require("../../libs/function/colorGradient.js").colorGradient;const{windowWidth:i}=t.index.getSystemInfoSync(),r={name:"u-tabs-swiper",emits:["update:modelValue","input","change"],props:{isScroll:{type:Boolean,default:!0},list:{type:Array,default:()=>[]},current:{type:[Number,String],default:0},height:{type:[Number,String],default:80},fontSize:{type:[Number,String],default:30},swiperWidth:{type:[String,Number],default:750},activeColor:{type:String,default:"#2979ff"},inactiveColor:{type:String,default:"#303133"},barWidth:{type:[Number,String],default:40},barHeight:{type:[Number,String],default:6},gutter:{type:[Number,String],default:40},zIndex:{type:[Number,String],default:1},bgColor:{type:String,default:"#ffffff"},autoCenterMode:{type:String,default:"window"},name:{type:String,default:"name"},count:{type:String,default:"count"},offset:{type:Array,default:()=>[5,20]},bold:{type:Boolean,default:!0},activeItemStyle:{type:Object,default:()=>({})},showBar:{type:Boolean,default:!0},barStyle:{type:Object,default:()=>({})}},data(){return{scrollLeft:0,tabQueryInfo:[],windowWidth:0,animationFinishCurrent:this.current,componentsWidth:0,line3AddDx:0,line3Dx:0,preId:"UEl_",sW:0,tabsInfo:[],colorGradientArr:[],colorStep:100}},computed:{getCurrent(){const t=Number(this.current);return t>this.getTabs.length-1?this.getTabs.length-1:t<0?0:t},getTabs(){return this.list},scrollBarLeft(){return Number(this.line3Dx)+Number(this.line3AddDx)},barWidthPx(){return t.index.upx2px(this.barWidth)},tabItemStyle(){return t=>{let e={height:this.height+"rpx",lineHeight:this.height+"rpx",padding:`0 ${this.gutter/2}rpx`,color:this.tabsInfo.length>0?this.tabsInfo[t]?this.tabsInfo[t].color:this.activeColor:this.inactiveColor,fontSize:this.fontSize+"rpx",zIndex:this.zIndex+2,fontWeight:t==this.getCurrent&&this.bold?"bold":"normal"};return t==this.getCurrent&&(e=Object.assign(e,this.activeItemStyle)),e}},tabBarStyle(){let t={width:this.barWidthPx+"px",height:this.barHeight+"rpx",borderRadius:"100px",backgroundColor:this.activeColor,left:this.scrollBarLeft+"px"};return Object.assign(t,this.barStyle)}},watch:{current(t,e){this.change(t),this.setFinishCurrent(t)},list(){this.$nextTick((()=>{this.init()}))}},mounted(){this.init()},methods:{async init(){this.countPx(),await this.getTabsInfo(),this.countLine3Dx(),this.getQuery((()=>{this.setScrollViewToCenter()})),this.colorGradientArr=e.colorGradient(this.inactiveColor,this.activeColor,this.colorStep)},getTabsInfo(){return new Promise(((e,i)=>{let r=t.index.createSelectorQuery().in(this);for(let t=0;t<this.list.length;t++)r.select(".UEl_"+t).boundingClientRect();r.exec((t=>{const i=[];for(let e=0;e<t.length;e++)t[e].color=this.inactiveColor,e==this.getCurrent&&(t[e].color=this.activeColor),i.push(t[e]);this.tabsInfo=i,e()}))}))},countLine3Dx(){const t=this.tabsInfo[this.animationFinishCurrent];t&&(this.line3Dx=t.left+t.width/2-this.barWidthPx/2-this.tabsInfo[0].left)},countPx(){this.sW=t.index.upx2px(Number(this.swiperWidth))},emit(t){this.$emit("change",t)},change(){this.setScrollViewToCenter()},getQuery(e){try{t.index.createSelectorQuery().in(this).select(".u-tabs").fields({size:!0},(t=>{t?(this.componentsWidth=t.width,e&&"function"==typeof e&&e(t)):this.getQuery(e)})).exec()}catch(r){this.componentsWidth=i}},setScrollViewToCenter(){let t;if(t=this.tabsInfo[this.animationFinishCurrent],t){let e,r=t.left+t.width/2;e="window"===this.autoCenterMode?i:this.componentsWidth,this.scrollLeft=r-e/2}},setDx(t){let e=t>0?this.animationFinishCurrent+1:this.animationFinishCurrent-1;e=e<=0?0:e,e=e>=this.list.length?this.list.length-1:e,this.tabsInfo[e];let i=this.tabsInfo[this.animationFinishCurrent],r=i.left+i.width/2,n=this.tabsInfo[e],s=n.left+n.width/2,o=Math.abs(s-r);this.line3AddDx=t/this.sW*o,this.setTabColor(this.animationFinishCurrent,e,t)},setTabColor(t,e,i){let r=Math.abs(Math.ceil(i/this.sW*100)),n=this.colorGradientArr.length;r=r>=n?n-1:r<=0?0:r,this.tabsInfo[e].color=this.colorGradientArr[r],this.tabsInfo[t].color=this.colorGradientArr[n-1-r]},setFinishCurrent(t){this.tabsInfo.map(((e,i)=>(e.color=t==i?this.activeColor:this.inactiveColor,e))),this.line3AddDx=0,this.animationFinishCurrent=t,this.countLine3Dx()}}};if(!Array){t.resolveComponent("u-badge")()}Math;var n=t._export_sfc(r,[["render",function(e,i,r,n,s,o){return t.e({a:t.f(o.getTabs,((e,i,n)=>({a:"355f53fe-0-"+n,b:t.p({count:e[r.count]||e.count||0,offset:r.offset,size:"mini"}),c:t.t(e[r.name]||e.name),d:t.s(o.tabItemStyle(i)),e:i,f:t.n(s.preId+i),g:t.o((t=>o.emit(i)),i)}))),b:r.showBar},r.showBar?{c:t.s(o.tabBarStyle)}:{},{d:r.isScroll?"":1,e:s.scrollLeft,f:r.zIndex+1,g:r.zIndex,h:r.bgColor})}],["__scopeId","data-v-355f53fe"]]);wx.createComponent(n);
