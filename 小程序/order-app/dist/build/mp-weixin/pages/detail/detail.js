"use strict";var e=require("../../common/vendor.js"),o=require("../../common/http.js"),a=require("../../store/car.js"),s=require("../../api/order.js"),r=require("../../store/order.js"),t=require("../../api/user.js");if(require("../../store/user.js"),!Array){(e.resolveComponent("u-swiper")+e.resolveComponent("u-parse")+e.resolveComponent("u-icon")+e.resolveComponent("u-badge"))()}Math||((()=>"../../uni_modules/vk-uview-ui/components/u-swiper/u-swiper.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-parse/u-parse.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-badge/u-badge.js"))();const n={__name:"detail",setup(n){const i=e.getCurrentInstance(),l=a.carStore(),u=r.orderStore(),d=e.computed$1((()=>l.carList.length)),c=e.ref("0"),v=e.ref(""),g=e.ref(0),p=e.ref("400");e.ref(!0),e.ref(!0);const m=e.ref(2e3),f=e.ref(500);e.ref([]);const w=e.ref([]),I=e.ref(""),h=e.ref(0),x=e.ref(""),C=e.ref({flag:!0,goodsName:"",goodsUnit:"",goodsId:"",num:1,specsName:"",price:"",goodsImage:""}),j=e.ref([]),N=e.ref(),b=e.ref(0);e.ref(0);const y=e.ref(0),S=e.ref(0),_=e.ref(0),q=()=>{let o="#content-wrap"+_.value,a=e.index.createSelectorQuery().in(i);a.select(o).boundingClientRect(),a.exec((e=>{console.log(e),e&&e[0]&&(S.value=e[0].height)}))},T=e=>{y.value=e,b.value=e,_.value=e,q()},k=()=>{l.addCar(C.value)},U=()=>{u.orderList=[],u.addOrder(C.value),e.index.navigateTo({url:"../confirm/confirm"})},A=({detail:{current:e}})=>{console.log(e),b.value=e,y.value=e},z=()=>{e.index.switchTab({url:"../index/index"})},L=()=>{e.index.switchTab({url:"../car/car"})},P=async()=>{if("0"==c.value){let o=await s.addCollectApi({openid:e.index.getStorageSync("openid"),goodsId:C.value.goodsId});o&&200==o.code&&($(),e.index.showToast({icon:"none",title:o.msg}))}else{let o=await s.cancelCollectApi({openid:e.index.getStorageSync("openid"),goodsId:C.value.goodsId});o&&200==o.code&&($(),e.index.showToast({icon:"none",title:o.msg}))}},$=async()=>{let o=await s.hasCollectApi({openid:e.index.getStorageSync("openid"),goodsId:C.value.goodsId});console.log(o),o.data&&"1"==o.data?c.value="1":c.value="0"};return e.onLoad((o=>{t.userLogin();const a=JSON.parse(decodeURIComponent(o.goods));w.value=a.goodsImage.split(","),console.log(a),x.value=a.goodsUnit,I.value=a.goodsName,h.value=a.specs[0].goodsPrice,j.value=a.specs,v.value=a.goodsDesc,C.value.goodsId=a.goodsId,C.value.goodsName=a.goodsName,C.value.goodsUnit=a.goodsUnit,C.value.specsName=a.specs[0].specsName,C.value.price=a.specs[0].goodsPrice,C.value.goodsImage=a.goodsImage.split(",")[0],$(),(async()=>{let e=await s.commentListApi({goodsId:C.value.goodsId});console.log(e),e&&200==e.code&&(N.value=e.data)})(),e.nextTick((()=>{q()}))})),(a,s)=>e.e({a:e.p({name:"images","border-radius":"1",duration:f.value,interval:m.value,height:p.value,list:w.value}),b:e.t(I.value),c:e.t(h.value),d:e.t(x.value),e:e.f(j.value,((o,a,s)=>({a:e.t(o.specsName),b:e.o((e=>((e,o)=>{g.value=e,h.value=o.goodsPrice,C.value.price=o.goodsPrice,C.value.specsName=o.specsName})(a,o))),c:g.value===a?1:""}))),f:e.o((e=>T(0))),g:e.n(0==y.value?"item-active":"item"),h:e.o((e=>T(1))),i:e.n(1==y.value?"item-active":"item"),j:e.p({html:v.value}),k:e.f(N.value,((a,s,r)=>({a:e.unref(o.http).baseUrl+a.avatarUrl,b:e.t(a.nickName),c:e.t(a.commentText),d:e.t(a.createTime),e:a.id}))),l:b.value,m:e.o(A),n:e.p({name:"home",size:40,color:a.$u.color.contentColor}),o:e.o(z),p:"1"==c.value},"1"==c.value?{q:e.p({color:"#F3AF28",size:40,name:"star"})}:{},{r:"0"==c.value},"0"==c.value?{s:e.p({size:40,name:"star"})}:{},{t:e.o(P),v:e.p({count:e.unref(d),type:"error",offset:[-3,-6]}),w:e.p({name:"shopping-cart",size:40,color:a.$u.color.contentColor}),x:e.o(L),y:e.o(k),z:e.o(U)})}};var i=e._export_sfc(n,[["__scopeId","data-v-06d78f09"]]);wx.createPage(i);
