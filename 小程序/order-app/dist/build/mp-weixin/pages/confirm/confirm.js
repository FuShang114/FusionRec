"use strict";var e=require("../../common/vendor.js"),r=require("../../store/order.js"),a=require("../../store/car.js"),s=require("../../store/address.js"),t=require("../../api/user.js"),d=require("../../api/order.js");if(require("../../common/http.js"),require("../../store/user.js"),!Array){e.resolveComponent("u-icon")()}Math;const o={__name:"confirm",setup(o){const n=r.orderStore(),i=a.carStore(),u=s.addressStore(),c=e.computed$1((()=>n.orderList)),p=e.computed$1((()=>{let e=0;return n.orderList.map((r=>{r.flag?e+=r.num:e+=0})),e})),m=e.computed$1((()=>{let e=0;return n.orderList.map((r=>{r.flag?e+=r.num*r.price:e+=0})),e})),l=r=>{e.index.navigateTo({url:"../addresslist/addresslist"})},g=async()=>{if(!u.address)return void e.index.showToast({title:"请填写收货地址",duration:2e3});let r=e.reactive({openid:e.index.getStorageSync("openid"),userName:u.userName,phone:u.phone,address:u.area+","+u.address,price:m.value,details:n.orderList});const a=await d.splaceOrderApi(r);console.log(a),a&&200==a.code&&(n.orderList=[],i.carList=[],e.index.navigateBack(),e.index.navigateTo({url:"../order/order"}))};return e.onLoad((()=>{(async()=>{let r=await t.getAddressApi({openid:e.index.getStorageSync("openid")});console.log(r),r&&200==r.code&&r.data&&(u.checkedId=r.data.addressId,u.userName=r.data.userName,u.phone=r.data.phone,u.area=r.data.area,u.address=r.data.address)})()})),(r,a)=>e.e({a:e.t(e.unref(u).userName),b:e.t(e.unref(u).phone),c:!e.unref(u).address},(e.unref(u).address,{}),{d:e.t(e.unref(u).area),e:e.t(e.unref(u).address),f:e.p({name:"arrow-right",color:"#c8c9cc"}),g:e.o(l),h:e.unref(c).length>0},e.unref(c).length>0?{i:e.f(e.unref(c),((r,a,s)=>({a:r.goodsImage,b:e.t(r.goodsName),c:e.t(r.specsName),d:e.t(r.price),e:e.t(r.goodsUnit),f:e.t(r.num),g:a})))}:{},{j:e.t(e.unref(m)),k:e.t(e.unref(p)),l:e.o(g)})}};wx.createPage(o);
